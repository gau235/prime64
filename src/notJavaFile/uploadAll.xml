<!DOCTYPE project>
<!-- 2021/10/23_17:00:00 -->
<!--you need activation.jar -->
<!--you need commons-net-3.0.jar -->
<!--you need javax.mail.jar -->
<!--you need java-json.jar -->

<project name="uploadAll" basedir="." default="end">

	<target name="init">

		<property name="rootDir" location="C:/e412/w/w20/WebContent/w20" />
		<property name="tmpDir" location="C:/tmp" />
		<property file="C:/passwordFtp.txt" />

		<property name="dirPrime64Lgpl" location="${tmpDir}/prime64Lgpl" />
		<property name="dirJarNUserGuide" location="${tmpDir}/jarNUserGuide" />

		<property name="dirPrime64Lgpl3Portable" location="${tmpDir}/prime64Lgpl3Portable" />
		<property name="dirPrime64Lgpl3DiyPortable" location="${tmpDir}/prime64Lgpl3DiyPortable" />

		<tstamp>
			<!-- for jarNUserGuide.zip -->
			<format property="myMMdd" pattern="MMdd" />
		</tstamp>

		<delete includeemptydirs="true">

			<fileset dir="${tmpDir}" includes="**/*" excludes="" />
		</delete>

		<echo message="begin subant buildJar.xml" />
		<subant failonerror="true" target="end">
			<fileset dir="." includes="buildJar.xml" />
		</subant>

		<echo message="begin to copy file ${rootDir}/../" />
		<copy todir="${tmpDir}">

			<fileset dir="${rootDir}/../" casesensitive="yes">
				<include name="**/*" />
			</fileset>

		</copy>

	</target>

	<target name="copyFile">

		<copy todir="${dirPrime64Lgpl3DiyPortable}">

			<fileset dir="C:/e412/prime64Lgpl3DiyPortable" casesensitive="yes">

			</fileset>

		</copy>

		<copy todir="${dirPrime64Lgpl3Portable}">

			<fileset dir="C:/e412/prime64Lgpl3Portable" casesensitive="yes">

			</fileset>

		</copy>

		<copy todir="${dirPrime64Lgpl3DiyPortable}/prime64Lgpl">

			<fileset dir="${dirPrime64Lgpl}" casesensitive="yes">

				<exclude name="src/*.bat2" />

			</fileset>

		</copy>

		<copy file="${dirPrime64Lgpl}/prime64Lgpl3.jar" tofile="${dirPrime64Lgpl3Portable}/prime64Lgpl3.jar" />

		<echo message="begin to copy index.jsp" />
		<copy todir="${dirPrime64Lgpl3DiyPortable}/tomcat/webapps/root" overwrite="true">

			<fileset dir="${rootDir}/../" casesensitive="yes">

				<include name="index.jsp" />

			</fileset>

		</copy>

		<copy todir="${dirPrime64Lgpl3DiyPortable}/tomcat/webapps">

			<fileset dir="${tmpDir}" casesensitive="yes">

				<include name="comb10/**" />

				<include name="w20/**" />
				<include name="r20/**" />

				<exclude name="w20/o/m.jsp" />

			</fileset>

		</copy>

		<!--for jarNUserGuide.zip============================================================-->
		<copy file="${rootDir}/prime64Old/userGuide.docx" tofile="${dirJarNUserGuide}/userGuide.docx" />
		<copy file="${dirPrime64Lgpl}/prime64Lgpl3.jar" tofile="${dirJarNUserGuide}/prime64Lgpl3_${myMMdd}.jar" />
		<copy todir="${dirJarNUserGuide}/srcTxtNDoc">

			<fileset dir="${tmpDir}/srcTxtNDoc" casesensitive="yes">
				<include name="**/*" />
			</fileset>

		</copy>

		<!--============================================================-->
		<copy file="${dirPrime64Lgpl}/prime64Lgpl3.jar" tofile="${dirPrime64Lgpl3DiyPortable}/tomcat/lib/prime64Lgpl3.jar" />

		<!--============================================================-->
		<copy file="${rootDir}/prime64Old/userGuide.docx" tofile="${dirPrime64Lgpl3DiyPortable}/userGuide.docx" />

		<!--============================================================-->
		<copy file="${dirPrime64Lgpl}/src/notJavaFile/playInJar.bat" tofile="${dirPrime64Lgpl3DiyPortable}/playInJar.bat" />
		<copy file="${dirPrime64Lgpl}/src/notJavaFile/playInTomcat.bat" tofile="${tmpDir}/prime64Lgpl3DiyPortable/playInTomcat.bat" />

		<!--============================================================-->
		<copy file="${dirPrime64Lgpl}/src/notJavaFile/play.bat" tofile="${dirPrime64Lgpl3Portable}/play.bat" />

		<!--to zip============================================================-->
		<zip destfile="${tmpDir}/w20/prime64Lgpl/jarNUserGuide.zip" encoding="UTF-8">

			<fileset dir="${dirJarNUserGuide}">

			</fileset>

		</zip>

		<!--
		<zip destfile="${tmpDir}/prime64Lgpl3DiyPortable.zip" encoding="UTF-8">

			<fileset dir="${dirPrime64Lgpl3DiyPortable}">

			</fileset>

		</zip>

		<zip destfile="${tmpDir}/prime64Lgpl3Portable.zip" encoding="UTF-8">

			<fileset dir="${dirPrime64Lgpl3Portable}">

			</fileset>

		</zip>



		<copy file="${tmpDir}/prime64Lgpl3DiyPortable.zip" todir="${tmpDir}/w20/prime64Lgpl" />
		<copy file="${tmpDir}/prime64Lgpl3Portable.zip" todir="${tmpDir}/w20/prime64Lgpl" />
-->

		<copy todir="${tmpDir}/w20/prime64Lgpl/srcTxtNDoc">

			<fileset dir="${tmpDir}/srcTxtNDoc" casesensitive="yes">

			</fileset>

		</copy>

		<echo message="begin to copy file ${tmpDir}/comb10/src" />

		<copy todir="${tmpDir}/comb10/src">

			<fileset dir="${tmpDir}/comb10" casesensitive="yes">
				<exclude name="**/Test.java" />
			</fileset>

			<globmapper from="*.jsp" to="*.txt" />

		</copy>

		<echo message="begin to copy file ${tmpDir}/comb10/test/src" />

		<copy todir="${tmpDir}/comb10/test/src">

			<fileset dir="${tmpDir}/comb10/test" casesensitive="yes">
				<exclude name="**/Test.java" />
			</fileset>

			<globmapper from="*.jsp" to="*.txt" />

		</copy>


		<echo message="begin to copy file ${tmpDir}/w20/calcu/src" />

		<copy todir="${tmpDir}/w20/calcu/src">

			<fileset dir="${tmpDir}/w20/calcu" casesensitive="yes">
				<exclude name="**/Test.java" />
			</fileset>

			<globmapper from="*.jsp" to="*.txt" />

		</copy>

		<copy todir="${tmpDir}/w20/calcu/src">

			<fileset dir="${tmpDir}/w20/calcu" casesensitive="yes">
				<exclude name="**/Test.java" />
			</fileset>

			<globmapper from="*.html" to="*.txt" />

		</copy>

		<copy todir="${tmpDir}/w20/fraction/src">

			<fileset dir="${tmpDir}/w20/fraction" casesensitive="yes">
				<exclude name="**/Test.java" />
			</fileset>

			<globmapper from="*.jsp" to="*.txt" />

		</copy>

		<copy todir="${tmpDir}/w20/fraction/src">

			<fileset dir="${tmpDir}/w20/fraction" casesensitive="yes">
				<exclude name="**/Test.java" />
			</fileset>

			<globmapper from="*.html" to="*.txt" />

		</copy>

		<copy todir="${tmpDir}/r20/main/src">

			<fileset dir="${tmpDir}/r20/main" casesensitive="yes">
				<exclude name="**/Test.java" />
			</fileset>

			<globmapper from="*.jsp" to="*.txt" />

		</copy>

		<copy todir="${tmpDir}/w20/minePrime/src">

			<fileset dir="${tmpDir}/w20/minePrime" casesensitive="yes">
				<exclude name="**/Test.java" />
			</fileset>

			<globmapper from="*.jsp" to="*.txt" />

		</copy>

		<copy todir="${tmpDir}/w20/t10/src">

			<fileset dir="${tmpDir}/w20/t10" casesensitive="yes">
				<exclude name="**/Test.java" />
			</fileset>

			<globmapper from="*.jsp" to="*.txt" />

		</copy>

		<copy todir="${tmpDir}/w20/twToCn/src">

			<fileset dir="${tmpDir}/w20/twToCn" casesensitive="yes">
				<exclude name="**/Test.java" />
			</fileset>

			<globmapper from="*.jsp" to="*.txt" />

		</copy>

	</target>

	<target name="toZip_comb10_r20_w20">

		<tstamp>
			<format property="myTime1" pattern="HH:mm:ss" />
		</tstamp>
		<echo message="myTime1=${myTime1}" />

		<zip destfile="${tmpDir}/tmpForZip/comb10.zip" encoding="UTF-8">

			<fileset dir="${tmpDir}/comb10">
				<!--		
				<exclude name="/WEB-INF/**" />-->

			</fileset>

		</zip>

		<zip destfile="${tmpDir}/tmpForZip/r20.zip" encoding="UTF-8">

			<fileset dir="${tmpDir}/r20">
				<!--		
						<exclude name="/WEB-INF/**" />-->

			</fileset>

		</zip>

		<zip destfile="${tmpDir}/tmpForZip/w20.zip" encoding="UTF-8">

			<fileset dir="${tmpDir}/w20">

				<!--
				<exclude name="/o/**" />
			 -->

			</fileset>

		</zip>

		<tstamp>
			<format property="myTime2" pattern="HH:mm:ss" />
		</tstamp>
		<echo message="myTime2=${myTime2}" />

	</target>

	<target name="toFtp">

		<tstamp>
			<format property="myTime3" pattern="HH:mm:ss" />
		</tstamp>
		<echo message="myTime3=${myTime3}" />



		<ftp action="del" server="c64.tw" verbose="yes" depends="yes" passive="yes" userid="c642584" password="${password}" remotedir="/WEB-INF/lib">

			<fileset>

				<include name="prime64Lgpl3.jar" />

			</fileset>

		</ftp>

		<ftp server="c64.tw" verbose="yes" depends="yes" passive="yes" userid="c642584" password="${password}" remotedir="/WEB-INF/lib">

			<fileset dir="${dirPrime64Lgpl}">

				<include name="prime64Lgpl3.jar" />

			</fileset>

		</ftp>

		<ftp server="c64.tw" verbose="yes" depends="yes" passive="yes" userid="c642584" password="${password}" remotedir="/tmpForZip">

			<fileset dir="${tmpDir}/tmpForZip">

				<include name="comb10.zip" />
				<include name="r20.zip" />
				<include name="w20.zip" />

			</fileset>

		</ftp>

		<tstamp>
			<format property="myTime4" pattern="HH:mm:ss" />
		</tstamp>
		<echo message="myTime4=${myTime4}" />

	</target>

	<target name="end" depends="init, copyFile, toZip_comb10_r20_w20, toFtp">

		<!---->
		<echo message="unzip" />
		<get src="http://c64.tw/w20/o/unzip.jsp" dest="${tmpDir}" />

		<echo message="insertDataOfSrcIntoDb" />
		<get src="http://c64.tw/w20/o/insertDataOfSrcIntoDb.jsp" dest="${tmpDir}" />

		<delete includeemptydirs="true">
			<fileset dir="${tmpDir}" includes="**/*" excludes="" />
		</delete>

	</target>

</project>